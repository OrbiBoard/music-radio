<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>设置</title>
  <link rel="stylesheet" href="../../../renderer/remixicon-local.css" />
  <style>
    html, body { height: 100%; margin: 0; background: #181818; color: #e6e6e6; font-family: system-ui, Segoe UI, PingFang SC, Microsoft YaHei, sans-serif; }
    .wrap { height: 100%; display: flex; flex-direction: column; }
    header { padding: 12px 16px; font-weight: 600; border-bottom: 1px solid #2a2a2a; }
    .content { padding: 16px; line-height: 1.8; }
    .content a { color: #9cd2ff; text-decoration: none; }
    ul { margin: 8px 0 0; padding-left: 20px; color: #c8c8c8; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="display:flex; align-items:center; justify-content:space-between;">
        <div style="font-weight:600;">设置</div>
        <div style="display:flex; gap:8px;">
          <button id="openBg" title="背景设置" style="border:0; background:#2a2a2a; color:#eee; padding:6px 10px; border-radius:8px; cursor:pointer; display:flex; align-items:center; gap:6px;"><i class="ri-contrast-drop-2-line"></i> 背景</button>
          <button id="openDebug" title="调试歌词" style="border:0; background:#2a2a2a; color:#eee; padding:6px 10px; border-radius:8px; cursor:pointer; display:flex; align-items:center; gap:6px;"><i class="ri-bug-line"></i> 调试</button>
        </div>
      </div>
    </header>
    <div class="content">
      <div style="margin-bottom:16px; padding-bottom:16px; border-bottom:1px solid #2a2a2a;">
        <div style="margin-bottom:8px; font-weight:600;">定时提醒</div>
        <div style="display:flex; align-items:center; gap:10px; font-size:13px; color:#aaa;">
          <span>当时间早于</span>
          <input type="time" id="endTime" style="background:#202020; border:1px solid #333; color:#eee; padding:4px 8px; border-radius:4px;">
          <span>时，若点歌后预计播放结束时间超过该点，则显示红字提示。</span>
        </div>
      </div>
    </div>
  </div>
  <script>
    (function(){
      const openBg = document.getElementById('openBg');
      const openDebug = document.getElementById('openDebug');
      const endTimeInput = document.getElementById('endTime');

      // Load Settings
      (async () => {
        try {
          const r = await window.lowbarAPI.pluginCall('music-radio', 'getSettings', []);
          const s = (r && r.result ? r.result.settings : (r && r.settings ? r.settings : {}));
          if (s && s.endTime && endTimeInput) endTimeInput.value = s.endTime;
        } catch (e) {}
      })();

      if (endTimeInput) {
        endTimeInput.addEventListener('change', async () => {
          try { await window.lowbarAPI.pluginCall('music-radio', 'setEndTime', [endTimeInput.value]); } catch (e) {}
        });
      }

      if (openBg) openBg.addEventListener('click', () => {
        try { window.lowbarAPI.pluginCall('music-radio','onLowbarEvent',[{ type:'click', id:'btn-bgmode' }]); } catch (e) {}
      });
      if (openDebug) openDebug.addEventListener('click', () => {
        try { window.lowbarAPI.pluginCall('music-radio','onLowbarEvent',[{ type:'click', id:'btn-debug-lyrics' }]); } catch (e) {}
      });
    })();
  </script>
</body>
</html>
